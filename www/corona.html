<!DOCTYPE html>
<html>
<head>
    <meta charset="utf-8">
    <title>Country-region-selector</title>
	<link rel="stylesheet"  href="css/corona.css">
</head>

<body onload="getGlobalStats()">
    
    <section>
        <h2>Global corona stats </h2>

        <p id="globalStats"></p>
         <hr size="1" />
    </section>

    <section id="main_content">
        <h2>For installation and configuration details about the script, see the <a href="https://github.com/benkeen/country-region-selector">main github readme.</a></h2>

        <div>
            Country: <select id="country-select" class="crs-country" data-region-id="one"  data-value="shortcode"></select>
        </div>
        <div>
            Region: <select id="one"></select>
        </div>
    </section>
    
    <section id="button">        
        <button onclick="getCountryStats()">Get info</button>
         <hr size="1" />
    </section>
    
    <section>
        <p id="location_info-country"></p>
        <p id="location_info-region"></p>
    </section>
    <section>
        <p>CSS stle sheet provided by https://colorlib.com/wp/template/fixed-header-table/</p>
    </section>
    </body>
    <script>
        function getCountryStats() {
            var countrySel = document.getElementById("country-select").value;
            var regionSel = document.getElementById("one");
            var xhttp = new XMLHttpRequest();
            xhttp.onreadystatechange = function() {
              if (this.readyState == 4 && this.status == 200) {
                  var countryStats = JSON.parse(this.responseText);
                var txt = "<table border='1'> <tr> <th>Country stats</th><th>Value</th></tr>";
                txt += "<tr> <td>Country flag</td><td><img src=" + countryStats.countryInfo.flag + "></td></tr>"
                for (var x in countryStats) {
                    var value = countryStats[x];
                    if (x == 'countryInfo') {
                        continue;
                    } else if (x =="updated") {
                        value = new Date(value);
                    }
                    txt += "<tr><td>" + x + "</td>";
                    txt += "<td>" + value + "</td></tr>";
                }
                txt += "</table>"   
                document.getElementById("location_info-country").innerHTML = txt;
            }
          };
          xhttp.open("GET", "https://meg-corona-stats.ew.r.appspot.com/country/" + countrySel, true);
          xhttp.send();
        }
        function getGlobalStats() {
          var xhttp = new XMLHttpRequest();
          xhttp.onreadystatechange = function() {
            if (this.readyState == 4 && this.status == 200) {
                var globalStats = JSON.parse(this.responseText);
                myObj = globalStats["results"][0];
                var txt = "<table border='1'> <tr> <th>Global stats</th><th>Value</th></tr>";
                for (var x in myObj) {
                    if (x == 'source') {
                        continue;
                    }
                    txt += "<tr><td>" + x.replace(/_/g, " ") + "</td>";
                    txt += "<td>" + myObj[x]+ "</td></tr>";
                }
                txt += "</table>"   
                document.getElementById("globalStats").innerHTML = txt;
            }
          };
          xhttp.open("GET", "https://meg-corona-stats.ew.r.appspot.com/global", true);
          xhttp.send();
        }
    </script>
    <script src="js/crs.min.js"></script>

</html>